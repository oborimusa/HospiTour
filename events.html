<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Events & Planning | HospiTour</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <style>
        :root{ 
            --hospitour-primary: #1a5276; 
            --hospitour-secondary: #3498db; 
            --hospitour-accent: #e67e22;
            --hospitour-light: #f8f9fa;
            --hospitour-dark: #2c3e50;
            --hospitour-success: #27ae60;
            --hospitour-warning: #f39c12;
            --hospitour-danger: #e74c3c;
            --hospitour-gray: #95a5a6;
        }
        
        body{ 
            font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; 
            background:#f5f7fa; 
            margin: 0;
            padding: 0;
        }
        
        .sidebar{ 
            width: 280px; 
            background: linear-gradient(180deg, var(--hospitour-primary) 0%, #154360 100%);
            height: 100vh; 
            position: fixed; 
            padding-top: 20px; 
            box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            z-index: 100;
        }
        
        .sidebar-brand {
            padding: 0 25px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .sidebar-brand h3 {
            color: white;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-brand h3 i {
            color: var(--hospitour-accent);
        }

        .sidebar-brand p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            margin: 5px 0 0 0;
        }
        
        .sidebar a{ 
            color: rgba(255, 255, 255, 0.85); 
            padding: 12px 25px; 
            display: flex;
            align-items: center;
            text-decoration: none; 
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            margin-bottom: 5px;
            font-weight: 500;
            position: relative;
        }
        
        .sidebar a i {
            margin-right: 12px;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .sidebar a:hover, .sidebar a.active{ 
            background: rgba(255,255,255,0.1); 
            color: white; 
            border-left: 4px solid var(--hospitour-accent); 
        }

        .sidebar a.active::after {
            content: "";
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 6px solid #f5f7fa;
        }
        
        .main-content{ 
            margin-left: 280px; 
            padding: 30px;
            min-height: 100vh;
        }
        
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--hospitour-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        .event-card {
            border-radius: 12px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            overflow: hidden;
            height: 100%;
            border-top: 4px solid var(--hospitour-primary);
        }
        
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .event-card-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .event-card-body {
            padding: 20px;
        }
        
        .event-type-badge {
            background: var(--hospitour-accent);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .task-list-item {
            border-left: 4px solid var(--hospitour-secondary);
            padding-left: 15px;
            transition: all 0.2s ease;
        }
        
        .task-list-item:hover {
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .task-completed {
            border-left-color: var(--hospitour-success);
            opacity: 0.8;
        }
        
        .task-overdue {
            border-left-color: var(--hospitour-danger);
        }
        
        .stats-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
            border-top: 4px solid var(--hospitour-primary);
        }
        
        .stats-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--hospitour-primary);
            margin-bottom: 5px;
        }
        
        .stats-label {
            color: var(--hospitour-dark);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .btn-hospitour {
            background: var(--hospitour-primary);
            color: white;
            border: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .btn-hospitour:hover {
            background: #154360;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(26, 82, 118, 0.3);
        }
        
        .btn-hospitour-secondary {
            background: var(--hospitour-secondary);
            color: white;
            border: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .btn-hospitour-secondary:hover {
            background: #2980b9;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(52, 152, 219, 0.3);
        }
        
        .btn-hospitour-outline {
            background: transparent;
            color: var(--hospitour-primary);
            border: 1px solid var(--hospitour-primary);
            font-weight: 500;
            padding: 10px 20px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .btn-hospitour-outline:hover {
            background: var(--hospitour-primary);
            color: white;
        }
        
        .calendar-widget {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-top: 4px solid var(--hospitour-primary);
        }
        
        .calendar-day {
            text-align: center;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .calendar-day:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        .calendar-day.event {
            background: var(--hospitour-accent);
            color: white;
            font-weight: 600;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 20px;
            width: 100%;
            padding: 0 25px;
        }
        
        .text-hospitour {
            color: var(--hospitour-primary);
        }
        
        .text-hospitour-secondary {
            color: var(--hospitour-secondary);
        }
        
        .plan-badge {
            background: var(--hospitour-accent);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 5px;
        }
        
        .notification-badge {
            background: var(--hospitour-accent);
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 0.7rem;
            margin-left: auto;
        }
        
        .feature-restricted {
            position: relative;
            opacity: 0.7;
        }
        
        .feature-restricted::after {
            content: "Upgrade Required";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .feature-restricted:hover::after {
            opacity: 1;
        }
        
        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
                overflow: hidden;
            }
            
            .sidebar .nav-text,
            .sidebar-brand p,
            .sidebar-brand h3 span {
                display: none;
            }
            
            .sidebar a i {
                margin-right: 0;
                font-size: 1.4rem;
            }
            
            .main-content {
                margin-left: 80px;
            }
            
            .notification-badge {
                position: absolute;
                top: 10px;
                right: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .sidebar a {
                display: inline-block;
                width: auto;
                margin: 5px;
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .sidebar a:hover, .sidebar a.active {
                border-left: none;
                border-bottom: 3px solid var(--hospitour-accent);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .sidebar-footer {
                position: relative;
                bottom: auto;
                margin-top: 20px;
            }
            
            .header-section {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    
    <div class="sidebar">
        <div class="sidebar-brand">
            <h3><i class="bi bi-building"></i> <span>HospiTour</span></h3>
            <p>Tourism Services Management</p>
        </div>

        <a href="dashboard.html">
            <i class="bi bi-speedometer2"></i>
            <span class="nav-text">Dashboard</span>
        </a>
        <a href="rooms.html">
            <i class="bi bi-house-door"></i>
            <span class="nav-text">Accommodation</span>
        </a>
        <a href="restaurant.html">
            <i class="bi bi-cup-hot"></i>
            <span class="nav-text">Restaurant & F&B</span>
        </a>
        <a href="tourism.html" class="active">
            <i class="bi bi-geo-alt"></i>
            <span class="nav-text">Tourism Services</span>
            <span class="notification-badge">5</span>
        </a>
        <a href="events.html">
            <i class="bi bi-calendar-event"></i>
            <span class="nav-text">Events & Planning</span>
        </a>
        <a href="staff.html">
            <i class="bi bi-people"></i>
            <span class="nav-text">Staff Management</span>
        </a>
        <a href="reports.html">
            <i class="bi bi-graph-up"></i>
            <span class="nav-text">Reports & Analytics</span>
        </a>
        <a href="settings.html">
            <i class="bi bi-gear"></i>
            <span class="nav-text">Settings & Billing</span>
        </a>

        <div class="sidebar-footer">
            <hr class="text-white-50" />
            <a href="#" id="logoutBtn" class="d-flex align-items-center">
                <i class="bi bi-box-arrow-right"></i>
                <span class="nav-text">Log Out</span>
            </a>
        </div>
    </div>

    <div class="main-content">
        <div class="header-section">
            <div>
                <h1 class="mb-2 text-hospitour">Events & Planning Management</h1>
                <p class="text-muted mb-0" id="planLevel">Loading Plan Level...</p>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">
                    <i class="bi bi-person-circle"></i>
                </div>
                <div>
                    <p class="mb-0 fw-bold" id="userName">Loading...</p>
                    <p class="mb-0 small text-muted" id="userEmail">Loading...</p>
                </div>
            </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
            <button class="btn btn-hospitour" data-bs-toggle="modal" data-bs-target="#newEventModal">
                <i class="bi bi-plus-circle"></i> Create New Event
            </button>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-hospitour-outline" id="vendorManagementBtn">
                    <i class="bi bi-people"></i> Vendor Management
                </button>
                <button class="btn btn-hospitour-outline" id="ticketingBtn">
                    <i class="bi bi-ticket-perforated"></i> Ticketing & Registration
                </button>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="row g-4 mb-5">
            <div class="col-md-3 col-sm-6">
                <div class="stats-card">
                    <div class="stats-number" id="upcomingEventsCount">5</div>
                    <div class="stats-label">Upcoming Events</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stats-card">
                    <div class="stats-number" id="pendingTasksCount">12</div>
                    <div class="stats-label">Pending Tasks</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stats-card">
                    <div class="stats-number" id="thisWeekEventsCount">3</div>
                    <div class="stats-label">This Week</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="stats-card">
                    <div class="stats-number" id="attentionEventsCount">2</div>
                    <div class="stats-label">Require Attention</div>
                </div>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-lg-8">
                <h3 class="mb-3 text-hospitour">Upcoming Events</h3>
                <div class="row g-4 mb-5" id="eventsContainer">
                    <!-- Events will be dynamically loaded here -->
                </div>
                
                <h3 class="mb-3 text-hospitour">Planning Tasks</h3>
                <div class="card p-4 mb-5">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="text-hospitour mb-0" id="selectedEventTitle">Q4 Sales Conference</h5>
                        <select class="form-select w-auto" id="eventSelector">
                            <option value="q4-conference">Q4 Sales Conference</option>
                            <option value="wedding">The Smiths' Wedding</option>
                            <option value="gala">Corporate Gala Dinner</option>
                            <option value="launch">Product Launch Event</option>
                        </select>
                    </div>
                    <ul class="list-group list-group-flush" id="tasksList">
                        <!-- Tasks will be dynamically loaded here -->
                    </ul>
                    <div class="mt-3">
                        <button class="btn btn-hospitour-outline btn-sm" id="addTaskBtn">
                            <i class="bi bi-plus"></i> Add New Task
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="calendar-widget mb-4">
                    <div class="calendar-header">
                        <h5 class="text-hospitour mb-0" id="calendarMonth">October 2025</h5>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-hospitour-outline" id="prevMonthBtn"><i class="bi bi-chevron-left"></i></button>
                            <button class="btn btn-sm btn-hospitour-outline" id="nextMonthBtn"><i class="bi bi-chevron-right"></i></button>
                        </div>
                    </div>
                    <div class="row text-center fw-bold small mb-2">
                        <div class="col p-1">S</div>
                        <div class="col p-1">M</div>
                        <div class="col p-1">T</div>
                        <div class="col p-1">W</div>
                        <div class="col p-1">T</div>
                        <div class="col p-1">F</div>
                        <div class="col p-1">S</div>
                    </div>
                    <div id="calendarDays">
                        <!-- Calendar days will be dynamically loaded here -->
                    </div>
                </div>
                
                <div class="card p-4">
                    <h5 class="text-hospitour mb-3">Quick Actions</h5>
                    <div class="d-grid gap-2">
                        <button class="btn btn-hospitour-outline text-start" id="generateReportBtn">
                            <i class="bi bi-file-earmark-text"></i> Generate Event Report
                        </button>
                        <button class="btn btn-hospitour-outline text-start" id="sendUpdatesBtn">
                            <i class="bi bi-envelope"></i> Send Client Updates
                        </button>
                        <button class="btn btn-hospitour-outline text-start" id="printScheduleBtn">
                            <i class="bi bi-printer"></i> Print Event Schedule
                        </button>
                        <button class="btn btn-hospitour-outline text-start" id="shareTeamBtn">
                            <i class="bi bi-share"></i> Share with Team
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- New Event Modal -->
    <div class="modal fade" id="newEventModal" tabindex="-1" aria-labelledby="newEventModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newEventModalLabel">Create New Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="newEventForm">
                        <div class="mb-3">
                            <label class="form-label">Event Name</label>
                            <input type="text" class="form-control" id="eventName" placeholder="Enter event name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Event Type</label>
                            <select class="form-select" id="eventType" required>
                                <option value="">Select Event Type</option>
                                <option value="wedding">Wedding</option>
                                <option value="conference">Conference</option>
                                <option value="gala">Gala Dinner</option>
                                <option value="meeting">Business Meeting</option>
                                <option value="birthday">Birthday Party</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Event Date</label>
                            <input type="date" class="form-control" id="eventDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-control" id="eventLocation" placeholder="Event location">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description and Notes</label>
                            <textarea class="form-control" id="eventDescription" rows="3" placeholder="Event details and special requirements"></textarea>
                        </div>
                        <button type="submit" class="btn btn-hospitour d-block w-100">Save Event</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal fade" id="addTaskModal" tabindex="-1" aria-labelledby="addTaskModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addTaskModalLabel">Add New Task</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addTaskForm">
                        <div class="mb-3">
                            <label class="form-label">Task Description</label>
                            <input type="text" class="form-control" id="taskDescription" placeholder="Enter task description" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Due Date</label>
                            <input type="date" class="form-control" id="taskDueDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Priority</label>
                            <select class="form-select" id="taskPriority" required>
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-hospitour d-block w-100">Add Task</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Initialize data and UI
        document.addEventListener('DOMContentLoaded', function() {
            initializeUserData();
            loadEvents();
            loadTasks('q4-conference');
            setupCalendar();
            setupEventListeners();
        });

        // User data management
        function initializeUserData() {
            let userData = localStorage.getItem('hospitour_business_user');
            
            if (!userData) {
                // Create default user data
                userData = {
                    name: 'Alex Johnson',
                    email: 'alex.johnson@hospitour.com',
                    plan: 'free',
                    lastLogin: new Date().toISOString(),
                    businessName: 'Grand Plaza Hotel'
                };
                localStorage.setItem('hospitour_business_user', JSON.stringify(userData));
            } else {
                userData = JSON.parse(userData);
            }
            
            updateUserInfo(userData);
            checkFeatureAccess(userData.plan);
            return userData;
        }

        function updateUserInfo(userData) {
            document.getElementById('userName').textContent = userData.name;
            document.getElementById('userEmail').textContent = userData.email;
            document.getElementById('planLevel').innerHTML = `Current Plan: <span class="plan-badge">${userData.plan.toUpperCase()}</span> | Subscription Active`;
        }

        // Feature access control based on plan
        function checkFeatureAccess(plan) {
            const restrictedFeatures = [
                'vendorManagementBtn',
                'ticketingBtn',
                'generateReportBtn',
                'sendUpdatesBtn',
                'printScheduleBtn',
                'shareTeamBtn'
            ];

            if (plan === 'free') {
                restrictedFeatures.forEach(featureId => {
                    const element = document.getElementById(featureId);
                    if (element) {
                        element.classList.add('feature-restricted');
                        element.disabled = true;
                        element.title = 'Upgrade to Pro or Enterprise plan to access this feature';
                    }
                });
            } else if (plan === 'pro') {
                // Enable some features for Pro users
                document.getElementById('vendorManagementBtn').classList.remove('feature-restricted');
                document.getElementById('vendorManagementBtn').disabled = false;
                document.getElementById('vendorManagementBtn').removeAttribute('title');
                
                document.getElementById('generateReportBtn').classList.remove('feature-restricted');
                document.getElementById('generateReportBtn').disabled = false;
                document.getElementById('generateReportBtn').removeAttribute('title');
                
                document.getElementById('printScheduleBtn').classList.remove('feature-restricted');
                document.getElementById('printScheduleBtn').disabled = false;
                document.getElementById('printScheduleBtn').removeAttribute('title');
            }
        }

        // Event management
        function loadEvents() {
            // In a real app, this would come from an API
            const events = [
                {
                    id: 'q4-conference',
                    name: 'Q4 Sales Conference',
                    type: 'Conference',
                    date: '2025-10-28',
                    location: 'Grand Ballroom',
                    status: 'warning',
                    statusText: '3 pending',
                    catering: 'External'
                },
                {
                    id: 'wedding',
                    name: 'The Smiths\' Wedding',
                    type: 'Wedding',
                    date: '2025-11-15',
                    location: 'Garden Terrace',
                    status: 'success',
                    statusText: 'On track',
                    catering: 'In-House'
                },
                {
                    id: 'gala',
                    name: 'Corporate Gala Dinner',
                    type: 'Gala',
                    date: '2025-12-05',
                    location: 'Main Dining Hall',
                    status: 'primary',
                    statusText: 'Planning',
                    catering: 'In-House'
                },
                {
                    id: 'launch',
                    name: 'Product Launch Event',
                    type: 'Launch',
                    date: '2026-01-12',
                    location: 'Conference Center',
                    status: 'secondary',
                    statusText: 'Not started',
                    catering: 'External'
                }
            ];

            const eventsContainer = document.getElementById('eventsContainer');
            eventsContainer.innerHTML = '';

            events.forEach(event => {
                const eventDate = new Date(event.date);
                const formattedDate = eventDate.toLocaleDateString('en-US', { 
                    month: 'long', 
                    day: 'numeric', 
                    year: 'numeric' 
                });

                const eventCard = document.createElement('div');
                eventCard.className = 'col-md-6';
                eventCard.innerHTML = `
                    <div class="event-card">
                        <div class="event-card-header">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h5 class="text-${event.status} mb-1">${event.name}</h5>
                                <span class="event-type-badge">${event.type}</span>
                            </div>
                            <p class="small text-muted mb-2">
                                <i class="bi bi-calendar"></i> ${formattedDate}<br>
                                <i class="bi bi-geo-alt"></i> ${event.location}
                            </p>
                        </div>
                        <div class="event-card-body">
                            <span class="badge bg-${event.catering === 'In-House' ? 'warning' : 'secondary'} mb-2">Catering: ${event.catering}</span>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <a href="#" class="small fw-bold text-decoration-none view-checklist" data-event-id="${event.id}">
                                    <i class="bi bi-list-check"></i> View Planning Checklist
                                </a>
                                <div class="text-${event.status}">
                                    <i class="bi bi-${getStatusIcon(event.status)}"></i> ${event.statusText}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                eventsContainer.appendChild(eventCard);
            });

            // Add event listeners to view checklist buttons
            document.querySelectorAll('.view-checklist').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const eventId = this.getAttribute('data-event-id');
                    document.getElementById('eventSelector').value = eventId;
                    loadTasks(eventId);
                });
            });
        }

        function getStatusIcon(status) {
            switch(status) {
                case 'warning': return 'exclamation-triangle';
                case 'success': return 'check-circle';
                case 'primary': return 'clock';
                case 'secondary': return 'dash-circle';
                default: return 'circle';
            }
        }

        // Task management
        function loadTasks(eventId) {
            // In a real app, this would come from an API
            const tasks = {
                'q4-conference': [
                    { id: 1, description: 'Finalize seating chart with client', dueDate: '2025-10-20', completed: false, overdue: false },
                    { id: 2, description: 'Catering menu approved', dueDate: '2025-10-15', completed: true, overdue: false },
                    { id: 3, description: 'Send final invoice reminder', dueDate: '2025-10-18', completed: false, overdue: true },
                    { id: 4, description: 'Confirm AV equipment setup', dueDate: '2025-10-25', completed: false, overdue: false },
                    { id: 5, description: 'Arrange transportation for speakers', dueDate: '2025-10-26', completed: false, overdue: false }
                ],
                'wedding': [
                    { id: 1, description: 'Finalize floral arrangements', dueDate: '2025-11-05', completed: false, overdue: false },
                    { id: 2, description: 'Confirm wedding cake design', dueDate: '2025-11-01', completed: true, overdue: false },
                    { id: 3, description: 'Schedule rehearsal dinner', dueDate: '2025-11-10', completed: false, overdue: false }
                ],
                'gala': [
                    { id: 1, description: 'Send invitations to VIP guests', dueDate: '2025-11-20', completed: false, overdue: false },
                    { id: 2, description: 'Finalize entertainment lineup', dueDate: '2025-11-25', completed: false, overdue: false }
                ],
                'launch': [
                    { id: 1, description: 'Book keynote speakers', dueDate: '2025-12-15', completed: false, overdue: false },
                    { id: 2, description: 'Design promotional materials', dueDate: '2025-12-20', completed: false, overdue: false }
                ]
            };

            const eventTitles = {
                'q4-conference': 'Q4 Sales Conference',
                'wedding': 'The Smiths\' Wedding',
                'gala': 'Corporate Gala Dinner',
                'launch': 'Product Launch Event'
            };

            document.getElementById('selectedEventTitle').textContent = eventTitles[eventId];
            const tasksList = document.getElementById('tasksList');
            tasksList.innerHTML = '';

            const eventTasks = tasks[eventId] || [];
            
            eventTasks.forEach(task => {
                const taskItem = document.createElement('li');
                taskItem.className = `list-group-item d-flex justify-content-between align-items-center task-list-item ${task.completed ? 'task-completed' : ''} ${task.overdue ? 'task-overdue' : ''}`;
                
                const dueDate = new Date(task.dueDate);
                const formattedDueDate = dueDate.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                taskItem.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="bi ${task.completed ? 'bi-check-circle text-success' : task.overdue ? 'bi-exclamation-circle text-danger' : 'bi-circle text-primary'} me-2"></i>
                        <span class="small ${task.completed ? 'text-muted text-decoration-line-through' : ''}">${task.description}</span>
                    </div>
                    <span class="badge bg-${task.completed ? 'success' : task.overdue ? 'danger' : 'info'}">${task.completed ? 'Complete' : `Due: ${formattedDueDate}`}</span>
                `;
                
                // Add click event to toggle task completion
                if (!task.completed) {
                    taskItem.addEventListener('click', function() {
                        toggleTaskCompletion(eventId, task.id);
                    });
                }
                
                tasksList.appendChild(taskItem);
            });

            // Update task counts
            updateTaskCounts(eventTasks);
        }

        function toggleTaskCompletion(eventId, taskId) {
            // In a real app, this would update the backend
            alert(`Task ${taskId} for event ${eventId} marked as completed!`);
            loadTasks(eventId);
        }

        function updateTaskCounts(tasks) {
            const pendingTasks = tasks.filter(task => !task.completed).length;
            const overdueTasks = tasks.filter(task => !task.completed && task.overdue).length;
            
            document.getElementById('pendingTasksCount').textContent = pendingTasks;
            document.getElementById('attentionEventsCount').textContent = overdueTasks;
        }

        // Calendar functionality
        function setupCalendar() {
            const currentDate = new Date();
            updateCalendar(currentDate);
            
            document.getElementById('prevMonthBtn').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar(currentDate);
            });
            
            document.getElementById('nextMonthBtn').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar(currentDate);
            });
        }

        function updateCalendar(date) {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            
            document.getElementById('calendarMonth').textContent = `${monthNames[date.getMonth()]} ${date.getFullYear()}`;
            
            const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
            const lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            let calendarHTML = '';
            let dayCounter = 1;
            
            // Event dates (in a real app, this would come from the events data)
            const eventDates = [28]; // October 28 has an event
            
            // Create calendar rows
            for (let i = 0; i < 6; i++) {
                calendarHTML += '<div class="row">';
                
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < startingDay) {
                        // Days from previous month
                        const prevMonthDays = new Date(date.getFullYear(), date.getMonth(), 0).getDate();
                        const day = prevMonthDays - startingDay + j + 1;
                        calendarHTML += `<div class="col p-1"><div class="calendar-day text-muted">${day}</div></div>`;
                    } else if (dayCounter > daysInMonth) {
                        // Days from next month
                        const day = dayCounter - daysInMonth;
                        calendarHTML += `<div class="col p-1"><div class="calendar-day text-muted">${day}</div></div>`;
                        dayCounter++;
                    } else {
                        // Current month days
                        const hasEvent = eventDates.includes(dayCounter);
                        calendarHTML += `<div class="col p-1"><div class="calendar-day ${hasEvent ? 'event' : ''}">${dayCounter}</div></div>`;
                        dayCounter++;
                    }
                }
                
                calendarHTML += '</div>';
                
                // Stop if we've displayed all days
                if (dayCounter > daysInMonth) break;
            }
            
            document.getElementById('calendarDays').innerHTML = calendarHTML;
        }

        // Event listeners
        function setupEventListeners() {
            // Event selector
            document.getElementById('eventSelector').addEventListener('change', function() {
                loadTasks(this.value);
            });
            
            // Add task button
            document.getElementById('addTaskBtn').addEventListener('click', function() {
                const modal = new bootstrap.Modal(document.getElementById('addTaskModal'));
                modal.show();
            });
            
            // New event form
            document.getElementById('newEventForm').addEventListener('submit', function(e) {
                e.preventDefault();
                createNewEvent();
            });
            
            // Add task form
            document.getElementById('addTaskForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addNewTask();
            });
            
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                logoutUser();
            });
            
            // Quick action buttons
            document.getElementById('generateReportBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Generating event report...');
                }
            });
            
            document.getElementById('sendUpdatesBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Sending client updates...');
                }
            });
            
            document.getElementById('printScheduleBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Printing event schedule...');
                }
            });
            
            document.getElementById('shareTeamBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Sharing with team...');
                }
            });
            
            document.getElementById('vendorManagementBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Opening vendor management...');
                }
            });
            
            document.getElementById('ticketingBtn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Opening ticketing & registration...');
                }
            });
        }

        function createNewEvent() {
            const eventName = document.getElementById('eventName').value;
            const eventType = document.getElementById('eventType').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventLocation = document.getElementById('eventLocation').value;
            const eventDescription = document.getElementById('eventDescription').value;
            
            // In a real app, this would save to a backend
            alert(`New event "${eventName}" created successfully!`);
            
            // Close modal and reset form
            const modal = bootstrap.Modal.getInstance(document.getElementById('newEventModal'));
            modal.hide();
            document.getElementById('newEventForm').reset();
            
            // Reload events to show the new one
            loadEvents();
        }

        function addNewTask() {
            const taskDescription = document.getElementById('taskDescription').value;
            const taskDueDate = document.getElementById('taskDueDate').value;
            const taskPriority = document.getElementById('taskPriority').value;
            
            // In a real app, this would save to a backend
            alert(`New task "${taskDescription}" added successfully!`);
            
            // Close modal and reset form
            const modal = bootstrap.Modal.getInstance(document.getElementById('addTaskModal'));
            modal.hide();
            document.getElementById('addTaskForm').reset();
            
            // Reload tasks to show the new one
            const currentEvent = document.getElementById('eventSelector').value;
            loadTasks(currentEvent);
        }

        function logoutUser() {
            if (confirm('Are you sure you want to log out?')) {
                localStorage.removeItem('hospitour_business_user');
                alert('Logged out successfully from HospiTour');
                window.location.href = 'login.html';
            }
        }
    </script>
</body>
</html>